; =============================================================================
; PJSIP Configuration for Asterisk
; https://docs.asterisk.org/Configuration/Channel-Drivers/SIP/Configuring-res_pjsip/
; =============================================================================

; -----------------------------------------------------------------------------
; Transports
; -----------------------------------------------------------------------------
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060

[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5060

[transport-tls]
type=transport
protocol=tls
bind=0.0.0.0:5061
cert_file=/etc/asterisk/keys/asterisk.crt
priv_key_file=/etc/asterisk/keys/asterisk.key
method=tlsv1_2

; -----------------------------------------------------------------------------
; Templates
; -----------------------------------------------------------------------------
[endpoint-basic](!)
type=endpoint
context=internal
disallow=all
allow=ulaw
allow=alaw
allow=g722
allow=opus
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
ice_support=yes
use_avpf=no
media_use_received_transport=yes
trust_id_inbound=yes
device_state_busy_at=1
dtmf_mode=rfc4733

[auth-userpass](!)
type=auth
auth_type=userpass

[aor-single-reg](!)
type=aor
max_contacts=1
remove_existing=yes
qualify_frequency=60
qualify_timeout=3

; -----------------------------------------------------------------------------
; Extensions (Users) - Add your extensions here
; -----------------------------------------------------------------------------

; Extension 100
[100](endpoint-basic)
auth=100
aors=100
callerid="User 100" <100>
mailboxes=100@default

[100](auth-userpass)
password=changeme100
username=100

[100](aor-single-reg)

; Extension 101
[101](endpoint-basic)
auth=101
aors=101
callerid="User 101" <101>
mailboxes=101@default

[101](auth-userpass)
password=changeme101
username=101

[101](aor-single-reg)

; Extension 102
[102](endpoint-basic)
auth=102
aors=102
callerid="User 102" <102>
mailboxes=102@default

[102](auth-userpass)
password=changeme102
username=102

[102](aor-single-reg)

; -----------------------------------------------------------------------------
; SIP Trunk Template (uncomment and configure for your provider)
; -----------------------------------------------------------------------------
; [trunk-provider]
; type=registration
; transport=transport-udp
; outbound_auth=trunk-provider-auth
; server_uri=sip:sip.provider.com
; client_uri=sip:your_username@sip.provider.com
; retry_interval=60
;
; [trunk-provider-auth]
; type=auth
; auth_type=userpass
; username=your_username
; password=your_password
;
; [trunk-provider-endpoint]
; type=endpoint
; transport=transport-udp
; context=from-trunk
; disallow=all
; allow=ulaw
; allow=alaw
; outbound_auth=trunk-provider-auth
; aors=trunk-provider-aor
; from_user=your_username
;
; [trunk-provider-aor]
; type=aor
; contact=sip:sip.provider.com
; qualify_frequency=60
;
; [trunk-provider-identify]
; type=identify
; endpoint=trunk-provider-endpoint
; match=sip.provider.com
